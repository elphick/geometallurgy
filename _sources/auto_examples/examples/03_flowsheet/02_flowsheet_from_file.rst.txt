
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/examples/03_flowsheet/02_flowsheet_from_file.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_examples_03_flowsheet_02_flowsheet_from_file.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_examples_03_flowsheet_02_flowsheet_from_file.py:


Flowsheet from File
===================

It is possible to create a Flowsheet object from a file.  This example demonstrates how to create a Flowsheet object
from a file.

.. GENERATED FROM PYTHON SOURCE LINES 9-21

.. code-block:: Python

    import inspect
    from pathlib import Path

    import pandas as pd
    from matplotlib import pyplot as plt

    from elphick.geomet.flowsheet import Flowsheet
    from elphick.geomet.flowsheet.stream import Stream
    from elphick.geomet.utils.data import sample_data

    __file__ = Path(inspect.getfile(inspect.currentframe())).resolve()








.. GENERATED FROM PYTHON SOURCE LINES 22-26

YAML file
---------

The yaml file needs to follow this structure.

.. GENERATED FROM PYTHON SOURCE LINES 27-32

.. code-block:: Python


    yaml_filepath: Path = Path(__file__).parents[2] / 'elphick/geomet/config/flowsheet_example_simple.yaml'
    yaml_config: str = yaml_filepath.read_text()
    yaml_config





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    'FLOWSHEET:\n  flowsheet:\n    name: Flowsheet\n  streams:  # graph edges\n    Feed:\n      name: Feed\n      node_in: feed\n      node_out: screen\n    Coarse:\n      name: Coarse\n      node_in: screen\n      node_out: lump\n    Fine:\n      name: Fine\n      node_in: screen\n      node_out: fines\n  operations:  # graph nodes\n    feed:\n      name: feed\n    screen:\n      name: screen\n    lump:\n      name: lump\n    fines:\n      name: fines\n'



.. GENERATED FROM PYTHON SOURCE LINES 33-35

Create Flowsheet
----------------

.. GENERATED FROM PYTHON SOURCE LINES 35-39

.. code-block:: Python


    fs: Flowsheet = Flowsheet.from_yaml(yaml_filepath)
    fs





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <elphick.geomet.flowsheet.flowsheet.Flowsheet object at 0x7f36e710a9c0>



.. GENERATED FROM PYTHON SOURCE LINES 40-42

The Flowsheet object can be visualized as a network.
The streams are not yet populated, so are shown in red.

.. GENERATED FROM PYTHON SOURCE LINES 42-45

.. code-block:: Python

    fs.plot()
    plt




.. image-sg:: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_001.png
   :alt: Flowsheet Nodes Healthy: True, Streams Healthy: False
   :srcset: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <module 'matplotlib.pyplot' from '/home/runner/work/geometallurgy/geometallurgy/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py'>



.. GENERATED FROM PYTHON SOURCE LINES 46-49

Load the data
-------------
Load data onto two of the three streams.

.. GENERATED FROM PYTHON SOURCE LINES 49-61

.. code-block:: Python


    df_feed: pd.DataFrame = sample_data()
    obj_feed: Stream = Stream(df_feed, name='Feed')

    # assume the Coarse stream is 0.4 of the Feed stream mass
    df_coarse: pd.DataFrame = df_feed.copy()
    df_coarse['wet_mass'] = df_coarse['wet_mass'] * 0.4
    df_coarse['mass_dry'] = df_coarse['mass_dry'] * 0.4
    obj_coarse: Stream = Stream(df_coarse, name='Coarse')

    fs.set_stream_data(stream_data={'Feed': obj_feed, 'Coarse': obj_coarse})








.. GENERATED FROM PYTHON SOURCE LINES 62-65

.. code-block:: Python

    fs.plot()
    plt




.. image-sg:: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_002.png
   :alt: Flowsheet Nodes Healthy: False, Streams Healthy: False
   :srcset: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <module 'matplotlib.pyplot' from '/home/runner/work/geometallurgy/geometallurgy/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py'>



.. GENERATED FROM PYTHON SOURCE LINES 66-68

Solve the flowsheet
-------------------

.. GENERATED FROM PYTHON SOURCE LINES 68-73

.. code-block:: Python


    fs.solve()
    fs.plot()
    plt




.. image-sg:: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_003.png
   :alt: Flowsheet Nodes Healthy: True, Streams Healthy: True
   :srcset: /auto_examples/examples/03_flowsheet/images/sphx_glr_02_flowsheet_from_file_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <module 'matplotlib.pyplot' from '/home/runner/work/geometallurgy/geometallurgy/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py'>



.. GENERATED FROM PYTHON SOURCE LINES 74-76

Plot the mass balance
---------------------

.. GENERATED FROM PYTHON SOURCE LINES 76-79

.. code-block:: Python


    fig = fs.table_plot(plot_type='network')
    fig





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="72f6bbf3-3e57-4bcf-a46f-a82a30532a8a" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("72f6bbf3-3e57-4bcf-a46f-a82a30532a8a")) {                    Plotly.newPlot(                        "72f6bbf3-3e57-4bcf-a46f-a82a30532a8a",                        [{"cells":{"align":"left","fill":{"color":[["whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke","whitesmoke","lightgray","whitesmoke"]]},"format":["%s",".0f",".0f",".1f",".2f",".2f",".2f",".2f"],"values":[["Feed","Coarse","Fine"],[300.0,120.0,180.0],[260.0,104.0,156.0],[13.333333333333334,13.333333333333334,13.333333333333334],[59.0,59.0,59.0],[3.5153846153846153,3.5153846153846153,3.5153846153846153],[1.8730769230769235,1.873076923076923,1.8730769230769235],[4.0,4.0,4.0]]},"columnwidth":[2,1,1,1,1,1,1,1],"header":{"align":"center","fill":{"color":"cornflowerblue"},"font":{"color":"black","size":12},"values":["name","wet_mass","mass_dry","H2O","Fe","SiO2","Al2O3","LOI"]},"type":"table","domain":{"x":[0.0,0.36000000000000004],"y":[0.0,1.0]}},{"hoverinfo":"none","line":{"color":"grey","width":2},"marker":{"angleref":"previous","color":"grey","size":16,"standoff":15,"symbol":"arrow"},"mode":"lines+markers","text":"Feed","x":[-1.0,-0.2],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"none","line":{"color":"grey","width":2},"marker":{"angleref":"previous","color":"grey","size":16,"standoff":15,"symbol":"arrow"},"mode":"lines+markers","text":"Coarse","x":[-0.2,0.6000000000000001],"y":[0.0,-0.4],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"none","line":{"color":"grey","width":2},"marker":{"angleref":"previous","color":"grey","size":16,"standoff":15,"symbol":"arrow"},"mode":"lines+markers","text":"Fine","x":[-0.2,0.6000000000000001],"y":[0.0,0.4],"type":"scatter","xaxis":"x","yaxis":"y"},{"customdata":["feed","screen","lump","fines"],"hoverinfo":"none","hovertemplate":"%{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":["grey","green","grey","grey"],"line":{"width":2},"size":30},"mode":"markers+text","text":["0","1","2","3"],"x":[-1.0,-0.2,0.6000000000000001,0.6000000000000001],"y":[0.0,0.0,-0.4,0.4],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"text","marker":{"color":"grey","line":{"width":1},"size":3},"mode":"markers","text":["Feed","Coarse","Fine"],"x":[-0.6,0.20000000000000004,0.20000000000000004],"y":[0.0,-0.2,0.2],"type":"scatter","xaxis":"x","yaxis":"y"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.4600000000000001,1.0],"showgrid":false,"zeroline":false,"showticklabels":false},"yaxis":{"anchor":"x","domain":[0.0,1.0],"showgrid":false,"zeroline":false,"showticklabels":false},"showlegend":false,"hovermode":"closest","paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)","title":{"text":"Flowsheet\u003cbr\u003e\u003csup\u003eNodes Healthy: \u003cspan style='color: black'\u003eTrue\u003c\u002fspan\u003e, Streams Healthy: \u003cspan style='color: black'\u003eTrue\u003c\u002fspan\u003e\u003c\u002fsup\u003e"},"font":{"size":12}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.091 seconds)


.. _sphx_glr_download_auto_examples_examples_03_flowsheet_02_flowsheet_from_file.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 02_flowsheet_from_file.ipynb <02_flowsheet_from_file.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 02_flowsheet_from_file.py <02_flowsheet_from_file.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
